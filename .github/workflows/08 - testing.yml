name: "Testing 123"

on: 
  push:
    branches:
      - master

jobs:
  job-1:
    name: Testing123
    runs-on: ubuntu-latest
    services:
      shlink:
        image: shlinkio/shlink:stable
        ports: 
          - 8080:8080
        env:
          IS_HTTPS_ENABLED: false
          GEOLITE_LICENSE_KEY: ${{ secrets.key }}
          DEFAULT_DOMAIN: bullshit.abc
        options: --name shlink
    steps:
      - name: Bastardise DNS
        run: echo "127.0.0.1 bullshit.abc" | sudo tee -a /etc/hosts

      - name: Generate Shlink API key
        id: shlink_api_key_stdout
        run: echo "::set-output name=zing::$(docker exec -it shlink shlink api-key:generate --no-ansi)""

      - name: Print Shlink API key in another step
        run: echo $shlinkapikey
        env:
          shlinkapikey: steps.shlink_api_key_stdout.outputs.zing
